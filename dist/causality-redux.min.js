/*
 ? 2017 Andrew Banks ALL RIGHTS RESERVED */
(function(x){function p(b){if(w[b])return w[b].exports;var e=w[b]={i:b,l:!1,exports:{}};x[b].call(e.exports,e,e.exports,p);e.l=!0;return e.exports}var w={};p.m=x;p.c=w;p.i=function(b){return b};p.d=function(b,e,n){p.o(b,e)||Object.defineProperty(b,e,{configurable:!1,enumerable:!0,get:n})};p.n=function(b){var e=b&&b.__esModule?function(){return b["default"]}:function(){return b};p.d(e,"a",e);return e};p.o=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};p.p="";return p(p.s=0)})([function(x,
p){(function(p){function b(n){if(e[n])return e[n].exports;var d=e[n]={i:n,l:!1,exports:{}};p[n].call(d.exports,d,d.exports,b);d.l=!0;return d.exports}var e={};b.m=p;b.c=e;b.i=function(b){return b};b.d=function(n,d,e){b.o(n,d)||Object.defineProperty(n,d,{configurable:!1,enumerable:!0,get:e})};b.n=function(n){var d=n&&n.__esModule?function(){return n["default"]}:function(){return n};b.d(d,"a",d);return d};b.o=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};b.p="";return b(b.s=1)})([function(p,
b){p.exports=Redux},function(p,b,e){function n(d){if(Array.isArray(d)){for(var b=0,n=Array(d.length);b<d.length;b++)n[b]=d[b];return n}return Array.from(d)}var d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(d){return typeof d}:function(d){return d&&"function"===typeof Symbol&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},w=e(0),x=function(){function b(a,d){if(a===d)return!0;var c=q(a),f=q(d);if(c.length!==f.length)return!1;for(var f=Object.prototype.hasOwnProperty,
b=0;b<c.length;b++)if(!f.call(d,c[b])||a[c[b]]!==d[c[b]])return!1;return!0}function e(a,c){T(c);var m=c.partitionName;a[m]={};var b=a[m];q(c.changers).forEach(function(m){var G=m+"Reducer";"undefined"===d(c.reducers[G])&&f("'Reducer: "+G+" not found.");b[m]=U(a,c,m,G)});b.subscribe=V(m);b.getState=W(a,m)}function p(a){var c=[];"undefined"!==d(a.changerDefinitions)&&(c=q(a.changerDefinitions));"undefined"!==d(a.changers)&&(c=[].concat(n(c),n(q(a.changers))));c.forEach(function(a){X.some(function(d){return d===
a})&&f(a+" is an invalid changer name.")});Y.forEach(function(c){"undefined"===d(a[c])&&f(c+" is a required entry in "+a.partitionName+".")});q(a).forEach(function(d){Z.some(function(a){return d===a})||f(d+" is not a valid entry in "+a.partitionName+".")});c.forEach(function(c){c=a.changerDefinitions[c];if("undefined"!==("undefined"===typeof c?"undefined":d(c))){var b=c.pluginId;if("undefined"!==("undefined"===typeof b?"undefined":d(b))){var m=H(b);"undefined"===("undefined"===typeof m?"undefined":
d(m))&&f("Plugin with id "+b+" is not defined");"function"===typeof m.validatePartitionEntry&&m.validatePartitionEntry(c)}}})}function P(a){a=[a];z=z.concat(a);a.forEach(function(a){p(a);aa(a);e(t,a)})}function Q(){A=v({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});A.onStateChange&&("function"!==typeof A.onStateChange&&f("options.onStateChange must be a function."),I=A.onStateChange);A.onListener&&("function"!==typeof A.onListener&&f("options.onListener must be a function."),F=A.onListener)}
function ba(a,c,m){var k=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};"undefined"===("undefined"===typeof a?"undefined":d(a))&&f("Missing first parameter partitionDefinitions.");Q(k);a.forEach(function(a){B[a.partitionName]=v({},a.defaultState)});var e={};"undefined"!==("undefined"===typeof c?"undefined":d(c))?[].concat(n(q(B)),n(q(c))).forEach(function(a){e[a]=v({},B[a],c[a])}):e=void 0;J=D(function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:B,c=arguments[1];C||(C=
v({},a));var h={};q(a).forEach(function(c){h[c]=a[c]});if("@@causality-redux/INIT"===c.type)return"undefined"===d(h[c.partitionName])?h[c.partitionName]=v({},c.defaultState):q(c.defaultState).forEach(function(a){"undefined"===d(h[c.partitionName][a])&&(h[c.partitionName][a]=c.defaultState[a])}),"undefined"===d(C[c.partitionName])?C[c.partitionName]=v({},c.defaultState):q(c.defaultState).forEach(function(a){"undefined"===d(C[c.partitionName][a])&&(C[c.partitionName][a]=c.defaultState[a])}),h;if("function"!==
typeof c.reducer)return h;h[c.partitionName]=c.reducer(a[c.partitionName],c);if(b(h[c.partitionName],a[c.partitionName]))return a;R(c.partitionName,c.type,c.operation,a[c.partitionName],h[c.partitionName],c.changerName,c.theirArgs);K[c.partitionName]=!0;return h},e,m);t=Object.create(J);t.subscribe(function(){var a=t.getState();q(K).forEach(function(c){E.forEach(function(h){if(c===h.partitionName){var b=a[c];if(0===h.stateEntries.length)L(c,b,h.listenerName),h.listener(b);else{var l=!0;"undefined"===
d(h.prevState)?h.stateEntries.forEach(function(a){l=l&&b[a]===C[c][a]}):h.stateEntries.forEach(function(a){l=l&&b[a]===h.prevState[a]});if(!l){var g={};h.stateEntries.forEach(function(a){g[a]=b[a]});h.prevState=g;L(c,g,h.listenerName);h.listener(g)}}}})});K={}});a.forEach(function(a){P(a)});return t}var k={STATE_COPY:1,STATE_ARRAY_ADD:2,STATE_ARRAY_DELETE:3,STATE_ARRAY_ENTRY_MERGE:4,STATE_OBJECT_MERGE:5,STATE_TOGGLE:6,STATE_FUNCTION_CALL:7,STATE_SETTODEFAULTS:8,STATE_INCREMENT:9,STATE_DECREMENT:10},
ca="arguments impliedArguments type operation arrayName keyIndexerName keyName arrayArgShape pluginId".split(" "),X=["getState","subscribe"],Z=["partitionName","defaultState","changers","reducers","changerDefinitions"],Y=["partitionName","defaultState"],da=["pluginId","reducer"],B={},t=null,J=null,K={},E=[],ea=0,z=[],A={},I=null,F=null,C=null,M=[],N=[],S=[],D=void 0;"undefined"!==("undefined"===typeof w.createStore?"undefined":d(w.createStore))&&(D=w.createStore);"undefined"===("undefined"===typeof D?
"undefined":d(D))&&("undefined"!==("undefined"===typeof Redux?"undefined":d(Redux))?D=Redux.createStore:f("Redux is undefined"));var f=function(a){throw Error("CausalityRedux: "+a);},v=Object.assign,y=function(a){return Object.prototype.toString.call(a).slice(8,-1)},q=function(a){return"undefined"===("undefined"===typeof a?"undefined":d(a))?[]:[].concat(n(Object.keys(a)),n(Object.getOwnPropertySymbols(a)))},O=function(a){return x.partitionDefinitions.find(function(c){return a===c.partitionName})},
H=function(a){return S.find(function(c){return a===c.pluginId})},R=function(a,c,b,f,k,e,n){"function"===typeof I&&(a={partitionName:a,type:c,operation:"undefined"===("undefined"===typeof b?"undefined":d(b))?"User defined":b,prevState:f,nextState:k,changerName:e,args:n},I(a))},L=function(a,c,d){"function"===typeof F&&F({partitionName:a,nextState:c,listenerName:d})},fa=function(a,c){var d=arguments[3],b=v([],2<arguments.length&&void 0!==arguments[2]?arguments[2]:[]),d={id:ea++,listener:a,partitionName:c,
stateEntries:b,listenerName:d};E.push(d);return d.id},ga=function(a){E=E.filter(function(c){return c.id!==a})},U=function(a,c,b,k){return function(){var m,e=(m=c.changers)[b].apply(m,arguments);if("undefined"===d(c.changerDefinitions[b])){if("undefined"===("undefined"===typeof e?"undefined":d(e))||"Object"!==y(e)){f("Changer "+b+" must return an action object.");return}}else if("undefined"===("undefined"===typeof e?"undefined":d(e)))return;e.type="undefined"===d(e.type)?"":e.type;e.reducer=c.reducers[k];
e.partitionName=c.partitionName;e.reducerName=k;a.dispatch(e)}},V=function(a){return function(c,b){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";Array.isArray(b)||f("subscribe: the 2nd argument must be an array of keys to listen on.");var k=O(a);b.forEach(function(c){var e=!1;"undefined"!==d(k.defaultState[c])?e=!0:q(k.changerDefinitions).forEach(function(a){a===c&&(1<b.length&&f("Can only subscribe to one changer event."),e=!0)});if(!e)throw c+" is not a valid key in the state partition "+
a+".";});return function(a){return function(){ga(a)}}(fa(c,a,b,e))}},W=function(a,c){return function(){return a.getState()[c]}},T=function(a){"undefined"===d(a.partitionName)&&f("partitionName not found.");"undefined"===d(a.defaultState)&&f("defaultState missing from entry: "+a.partitionName);"undefined"===d(a.changers)&&f("changers missing from entry: "+a.partitionName);"undefined"===d(a.reducers)&&f("reducers missing from entry: "+a.partitionName)},aa=function(a){if(a.changerDefinitions){var c=
function(a){return a===k.STATE_ARRAY_ADD||a===k.STATE_ARRAY_DELETE||a===k.STATE_ARRAY_ENTRY_MERGE},b=function(a,c,b,g){g.length!==b.length&&f("Incorrect number of arguments for "+c+" call.");for(var h=0;h<g.length;++h)"undefined"===d(a[b[h]])?f('Invalid argument name "'+b[h]+'" for '+c+" call."):"Object"!==y(a[b[h]])&&y(a[b[h]])!==y(g[h])&&f("Incorrect argument type for argument #"+(h+1)+" for "+c+" call.")},e=function(a,c){var b=q(a),h=q(c),f="";b.some(function(b){"undefined"===d(c[b])?f=b+" is missing in the first argument":
a[b]!==y(c[b])&&(f="Invalid type for "+b+" in the first argument");return""!==f});""===f&&h.some(function(c){"undefined"===d(a[c])&&(f="'"+c+"' is an invalid field in the first argument");return""!==f});return f},p=function(b){q(b).forEach(function(c){ca.some(function(a){return c===a})||f(c+" is an invalid entry in "+a.partitionName+".")});"undefined"!==d(b.arguments)&&(Array.isArray(b.arguments)||f("'arguments' must be an array for '"+o+"' in partitionName = "+a.partitionName+"."));c(b.operation)?
("undefined"!==d(b.keyIndexerName)&&"undefined"===d(b.keyName)&&f("The keyIndexerName is defined in "+o+" but keyName is not defined."),"undefined"===d(a.defaultState[b.arrayName])?f("Missing the 'arrayName' definition for entry '"+o+"' in partitionName = "+a.partitionName+"."):Array.isArray(a.defaultState[b.arrayName])||f(b.arrayName+" is not an array for entry '"+o+"' in partitionName = "+a.partitionName+".")):b.operation===k.STATE_TOGGLE?("undefined"!==d(b.impliedArguments)&&0!==b.impliedArguments.length||
f("impliedArguments is required for '"+o+"' in partitionName = "+a.partitionName+"."),b.impliedArguments.forEach(function(c){"Boolean"!==y(a.defaultState[c])&&f("The impliedArgument "+c+" is not Boolean as required by the Toggle operation in '"+o+"' of partitionName = "+a.partitionName+".")})):b.operation===k.STATE_INCREMENT||b.operation===k.STATE_DECREMENT?("undefined"!==d(b.impliedArguments)&&1===b.impliedArguments.length||f("impliedArguments with 1 entry is required for '"+o+"' in stateName = "+
a.stateName+"."),b.impliedArguments.forEach(function(c){"Number"!==y(a.defaultState[c])&&f("The impliedArgument "+c+" is not a Number as required by the "+b.operation+" operation in '"+o+"' of partitionName = "+a.partitionName+".")})):b.operation===k.STATE_OBJECT_MERGE?("undefined"!==d(b.arguments)&&0!==b.arguments.length||f("'arguments' is required for '"+o+"' in partitionName = "+a.partitionName+"."),1!==b.arguments.length&&f("STATE_OBJECT_MERGE allows only 1 argument for '"+o+"' in partitionName = "+
a.partitionName+".")):b.operation===k.STATE_SETTODEFAULTS&&("undefined"!==d(b.impliedArguments)&&0!==b.impliedArguments.length||f("'impliedArguments' is required for '"+o+"' in partitionName = "+a.partitionName+"."))},w=function(h,m,l){return function(){for(var g=arguments.length,u=Array(g),p=0;p<g;p++)u[p]=arguments[p];var r=[].concat(u);if(l.operation===k.STATE_FUNCTION_CALL){var q=[];E.forEach(function(a){Array.isArray(a.stateEntries)||f("Listenername="+a.listenerName+", partitionName="+a.partitionName+
" is not an array.");a.stateEntries.forEach(function(c){c===m&&q.push(a)})});0===q.length&&f("There is no subscriber to "+m+" in "+h+".");if(l.impliedArguments){var v=t[h].getState();if(v){var w={};l.impliedArguments.forEach(function(a){w[a]=v[a]});r.push(w)}}var x={functionArguments:r};R(h,m,l.operation,{},x,m,r);q.forEach(function(a){L(h,x,a.listenerName);a.listener.apply(a,n(r))})}else{g={};g.changerName=m;g.theirArgs=r;g.type="undefined"===d(l.type)?m:l.type;g.arguments="undefined"===d(l.arguments)?
[]:l.arguments;g.impliedArguments="undefined"===d(l.impliedArguments)?[]:l.impliedArguments;g.operation="undefined"===d(l.operation)?k.STATE_COPY:l.operation;g.partitionName=h;g.changerDefinition=l;if("undefined"!==d(l.pluginId))return u=H(l.pluginId),"function"===typeof u.validateChangerArguments&&u.validateChangerArguments.apply(u,n(r)),g;if(c(l.operation))l.operation===k.STATE_ARRAY_ADD&&"Object"!==y(r[0])&&f("STATE_ARRAY_ADD can only accept pure base objects. You must define your own changers and reducers for this object."),
l.operation===k.STATE_ARRAY_ADD||l.operation===k.STATE_ARRAY_DELETE?(1!==r.length&&f("Only one argument is allowed with "+l.operation+" for entry '"+m+"' in partitionName = "+a.partitionName+"."),l.operation===k.STATE_ARRAY_ADD&&"undefined"!==d(l.arrayArgShape)&&(u=e(l.arrayArgShape,r[0]),""!==u&&f(u+" for "+m))):(2!==r.length&&f("Two arguments are required with "+l.operation+" for entry '"+m+"' in partitionName = "+a.partitionName+"."),"undefined"!==d(l.arrayArgShape)&&(u=e(l.arrayArgShape,r[1]),
""!==u&&f(u+" for "+m))),g.arrayArg=l.operation===k.STATE_ARRAY_DELETE||l.operation===k.STATE_ARRAY_ENTRY_MERGE?r[0].toString():r[0],g.arrayEntryArg=r[1],g.arrayName=l.arrayName,g.keyIndexerName=l.keyIndexerName,g.keyName=l.keyName;else if(l.operation===k.STATE_OBJECT_MERGE)1!==r.length&&f("STATE_OBJECT_MERGE allows only 1 argument for "+m+"."),g[g.arguments[0]]=r[0];else if(l.operation===k.STATE_SETTODEFAULTS||l.operation===k.STATE_TOGGLE)0!==r.length&&f(l.operation+" allows only 0 arguments for "+
m);else if(l.operation!==k.STATE_FUNCTION_CALL&&(b(a.defaultState,m,g.arguments,r),0<r.length))for(u=0;u<r.length;++u)g[g.arguments[u]]=r[u];return g}}},x=function(a,c){return function(b,g){var e=v({},b);b=[];var h=b=void 0;"undefined"===d(g.operation)&&(g.operation=k.STATE_COPY);switch(g.operation){case k.STATE_COPY:g.arguments.forEach(function(a){e[a]=g[a]});break;case k.STATE_TOGGLE:g.impliedArguments.forEach(function(a){e[a]=!e[a]});break;case k.STATE_INCREMENT:g.impliedArguments.forEach(function(a){e[a]+=
1});break;case k.STATE_DECREMENT:g.impliedArguments.forEach(function(a){--e[a]});break;case k.STATE_SETTODEFAULTS:c.impliedArguments.forEach(function(a){e[a]=B[g.partitionName][a]});break;case k.STATE_ARRAY_ADD:b=[].concat(n(e[g.arrayName]));g.keyIndexerName&&(h=parseInt(e[g.keyIndexerName])||0,g.arrayArg[g.keyName]=h.toString(),++h,e[g.keyIndexerName]=h.toString());b.push(g.arrayArg);e[g.arrayName]=b;break;case k.STATE_ARRAY_DELETE:b=e[g.arrayName].filter(function(a){return a[g.keyName]!==g.arrayArg});
e[g.arrayName]=b;break;case k.STATE_ARRAY_ENTRY_MERGE:b=[].concat(n(e[g.arrayName]));h=e[g.arrayName].findIndex(function(a){return a[g.keyName]===g.arrayArg});0<=h&&(b[h]=v(b[h],g.arrayEntryArg),e[g.arrayName]=b);break;case k.STATE_OBJECT_MERGE:b=g.arguments[0];e[b]=v(e[b],g[b]);break;default:f("Unknown operation entry in "+a+".")}return e}};"undefined"===d(a.changers)&&(a.changers={});"undefined"===d(a.reducers)&&(a.reducers={});q(a.changerDefinitions).forEach(function(c){var b=a.changerDefinitions[c];
"undefined"===("undefined"===typeof b?"undefined":d(b))&&f("Changer definition argument for "+c+" must be defined");p(b);a.changers[c]=w(a.partitionName,c,b);var e=c+"Reducer";"undefined"===d(a.reducers[e])&&("undefined"!==d(b.pluginId)?a.reducers[e]=H(b.pluginId).reducer:a.reducers[e]=x(c,b))})}},ha=function(a){da.forEach(function(b){"undefined"===d(a[b])&&f("Key "+b+" is missing from the plugin.")})};return{createStore:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],b=
arguments[1],e=arguments[2],k=arguments[3];null!==t&&f("CausalityRedux is already initialized.");a=a.filter(function(a){return"undefined"===d(O(a.partitionName))});a=z.concat(a);z=[];t=ba(a,b,e,k);M.forEach(function(a){return a()});M=[];N.forEach(function(a){"undefined"===d(t[a.partitionName])&&f("${e.partitionName} is an invalid partition.");t[a.partitionName].subscribe(a.listener,a.arrKeys,a.listenerName)});N=[];return t},addPartitions:function(a){Array.isArray(a)||(a=[a]);a=a.filter(function(a){return"undefined"===
d(O(a.partitionName))});null!==t?a.forEach(function(a){B[a.partitionName]=v({},a.defaultState);var b={type:"@@causality-redux/INIT"};b.defaultState=a.defaultState;b.partitionName=a.partitionName;t.dispatch(b);P(a)}):z=z.concat(a)},addPlugin:function(a){ha(a);S.push(a)},subscribe:function(a,b,e,k){"function"!==typeof b&&f("subscribe listener argument is not a function.");Array.isArray(e)||f("subscribe: the 3rd argument must be an array of keys to listen on.");null!==t?("undefined"===d(t[a])&&f("${partitionName} is an invalid partition."),
t[a].subscribe(b,e,k)):N.push({partitionName:a,listener:b,arrKeys:e,listenerName:k})},onStoreCreated:function(a){"function"!==typeof a&&f("onStoreCreated argument is not a function.");null!==t?a():M.push(a)},setOptions:Q,get store(){return t},get reduxStore(){return J},get operations(){return k},get partitionDefinitions(){return z},get onListener(){return F},get defaultState(){return B},get shallowEqual(){return b},get merge(){return v}}}();"undefined"!==typeof window&&(window.CausalityRedux=x);p.exports=
x}])}]);
