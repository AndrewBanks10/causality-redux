/*
 ? 2017 Andrew Banks ALL RIGHTS RESERVED */
(function(x){function l(b){if(w[b])return w[b].exports;var e=w[b]={i:b,l:!1,exports:{}};x[b].call(e.exports,e,e.exports,l);e.l=!0;return e.exports}var w={};l.m=x;l.c=w;l.i=function(b){return b};l.d=function(b,e,u){l.o(b,e)||Object.defineProperty(b,e,{configurable:!1,enumerable:!0,get:u})};l.n=function(b){var e=b&&b.__esModule?function(){return b["default"]}:function(){return b};l.d(e,"a",e);return e};l.o=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};l.p="";return l(l.s=0)})([function(x,
l){(function(l){function b(u){if(e[u])return e[u].exports;var c=e[u]={i:u,l:!1,exports:{}};l[u].call(c.exports,c,c.exports,b);c.l=!0;return c.exports}var e={};b.m=l;b.c=e;b.i=function(b){return b};b.d=function(e,c,l){b.o(e,c)||Object.defineProperty(e,c,{configurable:!1,enumerable:!0,get:l})};b.n=function(e){var c=e&&e.__esModule?function(){return e["default"]}:function(){return e};b.d(c,"a",c);return c};b.o=function(b,c){return Object.prototype.hasOwnProperty.call(b,c)};b.p="";return b(b.s=1)})([function(l,
b){l.exports=Redux},function(l,b,e){function u(c){if(Array.isArray(c)){for(var b=0,e=Array(c.length);b<c.length;b++)e[b]=c[b];return e}return Array.from(c)}var c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"===typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},w=e(0),x=function(){function b(a,c){if(a===c)return!0;var d=Object.keys(a),b=Object.keys(c);if(d.length!==b.length)return!1;for(var b=
Object.prototype.hasOwnProperty,f=0;f<d.length;f++)if(!b.call(c,d[f])||a[d[f]]!==c[d[f]])return!1;return!0}function e(a,d){"undefined"===c(d.partitionName)&&f("partitionName not found.");"undefined"===c(d.defaultState)&&f("defaultState missing from entry: "+d.partitionName);"undefined"===c(d.changers)&&f("changers missing from entry: "+d.partitionName);"undefined"===c(d.reducers)&&f("reducers missing from entry: "+d.partitionName);a[d.partitionName]={};for(var b in d.changers){var e=b+"Reducer";"undefined"===
c(d.reducers[e])&&f("'Reducer: "+e+" not found.");a[d.partitionName][b]=function(b,f){return function(){var e,p=(e=d.changers)[b].apply(e,arguments);"undefined"!==("undefined"===typeof p?"undefined":c(p))&&(p.type="undefined"===c(p.type)?"":p.type,p.reducer=d.reducers[f],p.partitionName=d.partitionName,p.reducerName=f,a.dispatch(p))}}(b,e)}a[d.partitionName].subscribe=function(a){return function(c,b){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";Array.isArray(b)||f("subscribe: the 2nd argument must be an array of keys to listen on.");
var e=Q(a);b.forEach(function(c){var d=!1;if("undefined"!==typeof e.defaultState[c])d=!0;else for(var R in e.changerDefinitions)R===c&&(1<b.length&&f("Can only subscribe to one changer event."),d=!0);if(!d)throw c+" is not a valid key in the state partition "+a+".";});return function(a){return function(){S(a)}}(T(c,a,b,d))}}(d.partitionName);a[d.partitionName].getState=function(a,c){return function(){return a.getState()[c]}}(a,d.partitionName)}function l(a){a=[a];r=r.concat(a);a.forEach(function(a){U.forEach(function(b){"undefined"===
c(a[b])&&f(b+" is a required entry in "+a.partitionName+".")});var b=function(c){V.some(function(a){return c===a})||f(c+" is not a valid entry in "+a.partitionName+".")},d;for(d in a)b(d);W(a);e(q,a)})}function X(a,d,e){var k=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};"undefined"===("undefined"===typeof a?"undefined":c(a))&&f("Missing first parameter partitionDefinitions.");z=y({},k);z.onStateChange&&("function"!==typeof z.onStateChange&&f("options.onStateChange must be a function."),
H=z.onStateChange);z.onListener&&("function"!==typeof z.onListener&&f("options.onListener must be a function."),E=z.onListener);a.forEach(function(a){B[a.partitionName]=y({},a.defaultState)});var G={};"undefined"!==("undefined"===typeof d?"undefined":c(d))?Object.keys(B).forEach(function(a){G[a]=y({},B[a],d[a])}):G=void 0;I=C(function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:B,c=arguments[1];J||(J=a);if("function"!==typeof c.reducer)return a;var d={};r.forEach(function(c){d[c.partitionName]=
a[c.partitionName]});d[c.partitionName]=c.reducer(a[c.partitionName],c);if(b(d[c.partitionName],a[c.partitionName]))return a;P(c.partitionName,c.type,c.operation,a[c.partitionName],d[c.partitionName],c.changerName,c.theirArgs);K[c.partitionName]=!0;return d},G,e);q=Object.create(I);q.subscribe(function(){var a=q.getState(),b=function(b){D.forEach(function(d){if(b===d.partitionName)if(0===d.stateEntries.length)L(b,a[b],d.listenerName),d.listener(a[b]);else{var f=!0;"undefined"===c(d.prevState)?d.stateEntries.forEach(function(c){f=
f&&a[b][c]===J[b][c]}):d.stateEntries.forEach(function(c){f=f&&a[b][c]===d.prevState[c]});if(!f){var e={};d.stateEntries.forEach(function(c){e[c]=a[b][c]});d.prevState=e;L(b,e,d.listenerName);d.listener(e)}}})},d;for(d in K)b(d);K={}});a.forEach(function(a){l(a)});return q}var k={STATE_COPY:1,STATE_ARRAY_ADD:2,STATE_ARRAY_DELETE:3,STATE_ARRAY_ENTRY_MERGE:4,STATE_OBJECT_MERGE:5,STATE_TOGGLE:6,STATE_FUNCTION_CALL:7,STATE_SETTODEFAULTS:8,STATE_INCREMENT:9,STATE_DECREMENT:10},Y="arguments impliedArguments type operation arrayName keyIndexerName keyName arrayArgShape".split(" "),
V=["partitionName","defaultState","changers","reducers","changerDefinitions"],U=["partitionName","defaultState"],B={},q=null,I=null,K={},D=[],Z=0,r=[],z={},H=null,E=null,J=null,M=[],N=[],f=function(a){throw Error("CausalityRedux: "+a);},y=Object.assign,C=void 0;"undefined"!==("undefined"===typeof w.createStore?"undefined":c(w.createStore))&&(C=w.createStore);"undefined"===("undefined"===typeof C?"undefined":c(C))&&("undefined"===("undefined"===typeof Redux?"undefined":c(Redux))&&f("Redux is undefined"),
C=Redux.createStore);var A=function(a){return Object.prototype.toString.call(a).slice(8,-1)},Q=function(a){return x.partitionDefinitions.find(function(c){return a===c.partitionName})},P=function(a,b,f,e,k,l,q){"function"===typeof H&&(a={partitionName:a,type:b,operation:"undefined"===("undefined"===typeof f?"undefined":c(f))?"User defined":f,prevState:e,nextState:k,changerName:l,args:q},H(a))},L=function(a,c,b){"function"===typeof E&&E({partitionName:a,nextState:c,listenerName:b})},S=function(a){D=
D.filter(function(c){return c.id!==a})},T=function(a,c){var b=arguments[3],d=y([],2<arguments.length&&void 0!==arguments[2]?arguments[2]:[]),b={id:Z++,listener:a,partitionName:c,stateEntries:d,listenerName:b};D.push(b);return b.id},W=function(a){if(a.changerDefinitions){var b=function(a,b,d,e){e.length!==d.length&&f("Incorrect number of arguments for "+b+" call.");for(var g=0;g<e.length;++g)"undefined"===c(a[d[g]])?f('Invalid argument name "'+d[g]+'" for '+b+" call."):"Object"!==A(a[d[g]])&&A(a[d[g]])!==
A(e[g])&&f("Incorrect argument type for argument #"+(g+1)+" for "+b+" call.")},e=function(a,b){var d=Object.keys(a),f=Object.keys(b),e="";d.some(function(d){"undefined"===c(b[d])?e=d+" is missing in the first argument":a[d]!==A(b[d])&&(e="Invalid type for "+d+" in the first argument");return""!==e});""===e&&f.some(function(b){"undefined"===c(a[b])&&(e="'"+b+"' is an invalid field in the first argument");return""!==e});return e},l=function(a){return a===k.STATE_ARRAY_ADD||a===k.STATE_ARRAY_DELETE||
a===k.STATE_ARRAY_ENTRY_MERGE},v;for(v in a.changerDefinitions){var p=a.changerDefinitions[v],w=function(c){Y.some(function(a){return c===a})||f(c+" is an invalid entry in "+a.partitionName+".")},r;for(r in p)w(r)}"undefined"===c(a.changers)&&(a.changers={});v=function(d){var g=a.changerDefinitions[d];"undefined"!==c(g.arguments)&&(Array.isArray(g.arguments)||f("'arguments' must be an array for '"+d+"' in partitionName = "+a.partitionName+"."));"undefined"===("undefined"===typeof g?"undefined":c(g))&&
f("Changer definition argument for "+d+" must be defined");l(g.operation)?("undefined"!==c(g.keyIndexerName)&&"undefined"===c(g.keyName)&&f("The keyIndexerName is defined in "+d+" but keyName is not defined."),"undefined"===c(a.defaultState[g.arrayName])?f("Missing the 'arrayName' definition for entry '"+d+"' in partitionName = "+a.partitionName+"."):Array.isArray(a.defaultState[g.arrayName])||f(g.arrayName+" is not an array for entry '"+d+"' in partitionName = "+a.partitionName+".")):g.operation===
k.STATE_TOGGLE?("undefined"!==c(g.impliedArguments)&&0!==g.impliedArguments.length||f("impliedArguments is required for '"+d+"' in partitionName = "+a.partitionName+"."),g.impliedArguments.forEach(function(c){"Boolean"!==A(a.defaultState[c])&&f("The impliedArgument "+c+" is not Boolean as required by the Toggle operation in '"+d+"' of partitionName = "+a.partitionName+".")})):g.operation===k.STATE_INCREMENT||g.operation===k.STATE_DECREMENT?("undefined"!==c(g.impliedArguments)&&1===g.impliedArguments.length||
f("impliedArguments with 1 entry is required for '"+d+"' in stateName = "+a.stateName+"."),g.impliedArguments.forEach(function(c){"Number"!==A(a.defaultState[c])&&f("The impliedArgument "+c+" is not a Number as required by the "+g.operation+" operation in '"+d+"' of partitionName = "+a.partitionName+".")})):g.operation===k.STATE_OBJECT_MERGE?("undefined"!==c(g.arguments)&&0!==g.arguments.length||f("'arguments' is required for '"+d+"' in partitionName = "+a.partitionName+"."),1!==g.arguments.length&&
f("STATE_OBJECT_MERGE allows only 1 argument for '"+d+"' in partitionName = "+a.partitionName+".")):g.operation===k.STATE_SETTODEFAULTS&&("undefined"!==c(g.impliedArguments)&&0!==g.impliedArguments.length||f("'impliedArguments' is required for '"+d+"' in partitionName = "+a.partitionName+"."));a.changers[d]=function(d,g,h){return function(){for(var m=arguments.length,t=Array(m),F=0;F<m;F++)t[F]=arguments[F];var n=[].concat(t);if(h.operation===k.STATE_FUNCTION_CALL){var O=[];D.forEach(function(a){Array.isArray(a.stateEntries)||
f("Listenername="+a.listenerName+", partitionName="+a.partitionName+" is not an array.");a.stateEntries.forEach(function(c){c===g&&O.push(a)})});0===O.length&&f("There is no subscriber to "+g+" in "+d+".");if(h.impliedArguments){var p=q[d].getState();if(p){var v={};h.impliedArguments.forEach(function(a){v[a]=p[a]});n.push(v)}}var r={functionArguments:n};P(d,g,h.operation,{},r,g,n);O.forEach(function(a){L(d,r,a.listenerName);a.listener.apply(a,u(n))})}else{m={};m.changerName=g;m.theirArgs=n;m.type=
"undefined"===c(h.type)?g:h.type;m.arguments="undefined"===c(h.arguments)?[]:h.arguments;m.impliedArguments="undefined"===c(h.impliedArguments)?[]:h.impliedArguments;m.operation="undefined"===c(h.operation)?k.STATE_COPY:h.operation;m.partitionName=d;if(l(h.operation))h.operation===k.STATE_ARRAY_ADD&&"Object"!==A(n[0])&&f("STATE_ARRAY_ADD can only accept pure base objects. You must define your own changers and reducers for this object."),h.operation===k.STATE_ARRAY_ADD||h.operation===k.STATE_ARRAY_DELETE?
(1!==n.length&&f("Only one argument is allowed with "+h.operation+" for entry '"+g+"' in partitionName = "+a.partitionName+"."),h.operation===k.STATE_ARRAY_ADD&&"undefined"!==c(h.arrayArgShape)&&(t=e(h.arrayArgShape,n[0]),""!==t&&f(t+" for "+g))):(2!==n.length&&f("Two arguments are required with "+h.operation+" for entry '"+g+"' in partitionName = "+a.partitionName+"."),"undefined"!==c(h.arrayArgShape)&&(t=e(h.arrayArgShape,n[1]),""!==t&&f(t+" for "+g))),m.arrayArg=h.operation===k.STATE_ARRAY_DELETE||
h.operation===k.STATE_ARRAY_ENTRY_MERGE?n[0].toString():n[0],m.arrayEntryArg=n[1],m.arrayName=h.arrayName,m.keyIndexerName=h.keyIndexerName,m.keyName=h.keyName;else if(h.operation===k.STATE_OBJECT_MERGE)1!==n.length&&f("STATE_OBJECT_MERGE allows only 1 argument for "+g+"."),m[m.arguments[0]]=n[0];else if(h.operation===k.STATE_SETTODEFAULTS||h.operation===k.STATE_TOGGLE)0!==n.length&&f(h.operation+" allows only 0 arguments for "+g);else if(h.operation!==k.STATE_FUNCTION_CALL&&(b(a.defaultState,g,m.arguments,
n),0<n.length))for(t=0;t<n.length;++t)m[m.arguments[t]]=n[t];return m}}}(a.partitionName,d,g);var v=d+"Reducer",p=void 0;"undefined"!==c(a.reducers)&&(p=a.reducers[v]);"undefined"!==("undefined"===typeof p?"undefined":c(p))?a.reducers[v]=function(a){return function(c,d){var b=[c];d.arguments.forEach(function(a){b.push(d[a])});return a.apply(void 0,b)}}(p):("undefined"===c(a.reducers)&&(a.reducers={}),a.reducers[v]=function(a){return function(d,b){var e=y({},d);d=[];var h=d=void 0;"undefined"===c(b.operation)&&
(b.operation=k.STATE_COPY);switch(b.operation){case k.STATE_COPY:b.arguments.forEach(function(a){e[a]=b[a]});break;case k.STATE_TOGGLE:b.impliedArguments.forEach(function(a){e[a]=!e[a]});break;case k.STATE_INCREMENT:b.impliedArguments.forEach(function(a){e[a]+=1});break;case k.STATE_DECREMENT:b.impliedArguments.forEach(function(a){--e[a]});break;case k.STATE_SETTODEFAULTS:g.impliedArguments.forEach(function(a){e[a]=B[b.partitionName][a]});break;case k.STATE_ARRAY_ADD:d=[].concat(u(e[b.arrayName]));
b.keyIndexerName&&(h=parseInt(e[b.keyIndexerName])||0,b.arrayArg[b.keyName]=h.toString(),++h,e[b.keyIndexerName]=h.toString());d.push(b.arrayArg);e[b.arrayName]=d;break;case k.STATE_ARRAY_DELETE:d=e[b.arrayName].filter(function(a){return a[b.keyName]!==b.arrayArg});e[b.arrayName]=d;break;case k.STATE_ARRAY_ENTRY_MERGE:d=[].concat(u(e[b.arrayName]));h=e[b.arrayName].findIndex(function(a){return a[b.keyName]===b.arrayArg});0<=h&&(d[h]=y(d[h],b.arrayEntryArg),e[b.arrayName]=d);break;case k.STATE_OBJECT_MERGE:d=
b.arguments[0];e[d]=y(e[d],b[d]);break;default:f("Unknown operation entry in "+a+".")}return e}}(d))};for(var x in a.changerDefinitions)v(x)}};return{createStore:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],b=arguments[1],c=arguments[2],e=arguments[3];null!==q&&f("CausalityRedux is already initialized.");a=r.concat(a);r=[];q=X(a,b,c,e);M.forEach(function(a){return a()});M=[];N.forEach(function(a){q[a.partitionName].subscribe(a.listener,a.arrKeys,a.listenerName)});N=[];
return q},addPartitions:function(a){null!==q&&f("CausalityRedux has already been initialized. This addPartition will not work.");Array.isArray(a)||(a=[a]);r=r.concat(a)},subscribe:function(a,b,c,e){"function"!==typeof b&&f("subscribe listener argument is not a function.");Array.isArray(c)||f("subscribe: the 3rd argument must be an array of keys to listen on.");null!==q?q[a].subscribe(b,c,e):N.push({partitionName:a,listener:b,arrKeys:c,listenerName:e})},onStoreCreated:function(a){"function"!==typeof a&&
f("onStoreCreated argument is not a function.");null!==q?a():M.push(a)},get store(){return q},get reduxStore(){return I},get operations(){return k},get partitionDefinitions(){return r},get onListener(){return E},get defaultState(){return B},get shallowEqual(){return b},get merge(){return y}}}();"undefined"!==typeof window&&(window.CausalityRedux=x);l.exports=x}])}]);
