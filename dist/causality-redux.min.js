/*
 ? 2017 Andrew Banks ALL RIGHTS RESERVED */
(function(A){function q(b){if(n[b])return n[b].exports;var d=n[b]={i:b,l:!1,exports:{}};A[b].call(d.exports,d,d.exports,q);d.l=!0;return d.exports}var n={};q.m=A;q.c=n;q.i=function(b){return b};q.d=function(b,d,t){q.o(b,d)||Object.defineProperty(b,d,{configurable:!1,enumerable:!0,get:t})};q.n=function(b){var d=b&&b.__esModule?function(){return b["default"]}:function(){return b};q.d(d,"a",d);return d};q.o=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};q.p="";return q(q.s=0)})([function(A,
q){(function(n){function b(t){if(d[t])return d[t].exports;var f=d[t]={i:t,l:!1,exports:{}};n[t].call(f.exports,f,f.exports,b);f.l=!0;return f.exports}var d={};b.m=n;b.c=d;b.i=function(b){return b};b.d=function(t,f,d){b.o(t,f)||Object.defineProperty(t,f,{configurable:!1,enumerable:!0,get:d})};b.n=function(d){var f=d&&d.__esModule?function(){return d["default"]}:function(){return d};b.d(f,"a",f);return f};b.o=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};b.p="";return b(b.s=4)})([function(n,
b,d){function t(a){if(Array.isArray(a)){for(var c=0,p=Array(a.length);c<a.length;c++)p[c]=a[c];return p}return Array.from(a)}function f(a,c){if(a===c)return!0;var p=u(a),g=u(c);if(p.length!==g.length)return!1;for(var g=Object.prototype.hasOwnProperty,e=0;e<p.length;e++)if(!g.call(c,p[e])||a[p[e]]!==c[p[e]])return!1;return!0}function q(a){var c=[];g(a.changerDefinitions)!==e&&(c=u(a.changerDefinitions));g(a.changers)!==e&&(c=[].concat(t(c),t(u(a.changers))));c.forEach(function(a){ba.some(function(c){return c===
a})&&h(a+" is an invalid changer name.")});ca.forEach(function(c){g(a[c])===e&&h(c+" is a required entry in "+a.partitionName+".")});u(a).forEach(function(c){da.some(function(a){return c===a})||h(c+" is not a valid entry in "+a.partitionName+".")});c.forEach(function(c){c=a.changerDefinitions[c];if(("undefined"===typeof c?"undefined":g(c))!==e){var p=c.pluginId;if(("undefined"===typeof p?"undefined":g(p))!==e){var b=I(p);("undefined"===typeof b?"undefined":g(b))===e&&h("Plugin with id "+p+" is not defined");
"function"===typeof b.validatePartitionEntry&&b.validatePartitionEntry(c)}}})}function U(a){a=[a];B=B.concat(a);a.forEach(function(a){q(a);ea(a);fa(w,a)})}function L(){C=y({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});C.onStateChange&&("function"!==typeof C.onStateChange&&h("options.onStateChange must be a function."),M=C.onStateChange);C.onListener&&("function"!==typeof C.onListener&&h("options.onListener must be a function."),J=C.onListener)}function A(a,c,p){var b=3<arguments.length&&
void 0!==arguments[3]?arguments[3]:{};("undefined"===typeof a?"undefined":g(a))===e&&h("Missing first parameter partitionDefinitions.");L(b);a.forEach(function(a){D[a.partitionName]=y({},a.defaultState)});var d={};("undefined"===typeof c?"undefined":g(c))!==e?[].concat(t(u(D)),t(u(c))).forEach(function(a){d[a]=y({},D[a],c[a])}):d=void 0;N=F(function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:D,c=arguments[1];E||(E=y({},a));var k={};u(a).forEach(function(c){k[c]=a[c]});if(c.type===
V)return g(k[c.partitionName])===e?k[c.partitionName]=y({},c.defaultState):u(c.defaultState).forEach(function(a){g(k[c.partitionName][a])===e&&(k[c.partitionName][a]=c.defaultState[a])}),g(E[c.partitionName])===e?E[c.partitionName]=y({},c.defaultState):u(c.defaultState).forEach(function(a){g(E[c.partitionName][a])===e&&(E[c.partitionName][a]=c.defaultState[a])}),k;if(c.isSetState)k[c.partitionName]=y({},a[c.partitionName],c.theirArgs);else if("function"===typeof c.reducer)k[c.partitionName]=c.reducer(a[c.partitionName],
c);else return"function"===typeof c.pluginCallback&&setTimeout.apply(void 0,[c.pluginCallback,1].concat(t(c.theirArgs))),a;if(f(k[c.partitionName],a[c.partitionName]))return a;W(c.partitionName,c.type,c.operation,a[c.partitionName],k[c.partitionName],c.changerName,c.theirArgs);O[c.partitionName]=!0;return k},d,p);w=Object.create(N);w.subscribe(function(){var a=w.getState();u(O).forEach(function(c){G.forEach(function(k){if(c===k.partitionName){var b=a[c];if(0===k.stateEntries.length)P(c,b,k.listenerName),
k.listener(b);else{var l=!0;g(k.prevState)===e?k.stateEntries.forEach(function(a){l=l&&b[a]===E[c][a]}):k.stateEntries.forEach(function(a){l=l&&b[a]===k.prevState[a]});if(!l){var r={};k.stateEntries.forEach(function(a){r[a]=b[a]});k.prevState=r;P(c,r,k.listenerName);k.listener(r)}}}})});O={}});a.forEach(function(a){U(a)});return w}function H(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],c=arguments[1],b=arguments[2],d=arguments[3];if(null!==w)return Q(a),L(d),w;a=a.filter(function(a){return g(R(a.partitionName))===
e});a=B.concat(a);B=[];w=A(a,c,b,d);S.forEach(function(a){return a()});S=[];T.forEach(function(a){g(w[a.partitionName])===e&&h("${e.partitionName} is an invalid partition.");w[a.partitionName].subscribe(a.listener,a.arrKeys,a.listenerName)});T=[];return w}function Q(a){Array.isArray(a)||(a=[a]);a=a.filter(function(a){return g(R(a.partitionName))===e});null!==w?a.forEach(function(a){D[a.partitionName]=y({},a.defaultState);var c={};c.type=V;c.defaultState=a.defaultState;c.partitionName=a.partitionName;
w.dispatch(c);U(a)}):B=B.concat(a)}function X(a){Array.isArray(a)||(a=[a]);a=a.filter(function(a){return g(I(a.pluginId))===e});a.forEach(function(a){ga(a);Y.push(a);g(a.partitionDefinitions)!==e&&K.addPartitions(a.partitionDefinitions);if("function"===typeof a.onStoreCreated)K.onStoreCreated(a.onStoreCreated)})}function Z(a,c,b,d){"function"!==typeof c&&h("subscribe listener argument is not a function.");Array.isArray(b)||h("subscribe: the 3rd argument must be an array of keys to listen on.");null!==
w?(g(w[a])===e&&h("${partitionName} is an invalid partition."),w[a].subscribe(c,b,d)):T.push({partitionName:a,listener:c,arrKeys:b,listenerName:d})}function aa(a){"function"!==typeof a&&h("onStoreCreated argument is not a function.");null!==w?a():S.push(a)}Object.defineProperty(b,"__esModule",{value:!0});b.getKeys=b.merge=b.operations=void 0;var g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===
Symbol&&a!==Symbol.prototype?"symbol":typeof a};b.shallowEqual=f;b.createStore=H;b.addPartitions=Q;b.addPlugins=X;b.subscribe=Z;b.onStoreCreated=aa;n=d(3);var ha=d(2),m=b.operations={STATE_COPY:1,STATE_ARRAY_ADD:2,STATE_ARRAY_DELETE:3,STATE_ARRAY_ENTRY_MERGE:4,STATE_OBJECT_MERGE:5,STATE_TOGGLE:6,STATE_FUNCTION_CALL:7,STATE_SETTODEFAULTS:8,STATE_INCREMENT:9,STATE_DECREMENT:10},ia="arguments impliedArguments type operation arrayName keyIndexerName keyName arrayArgShape pluginId".split(" "),ba=["setState",
"getState","subscribe","partitionState"],da=["partitionName","defaultState","changers","reducers","changerDefinitions"],ca=["partitionName","defaultState"],ja=["pluginId"],e="undefined",D={},V="@@causality-redux/INIT",w=null,N=null,O={},G=[],ka=0,B=[],C={},M=null,J=null,E=null,S=[],T=[],Y=[],F=void 0;("undefined"===typeof n.createStore?"undefined":g(n.createStore))!==e&&(F=n.createStore);("undefined"===typeof F?"undefined":g(F))===e&&(("undefined"===typeof Redux?"undefined":g(Redux))!==e?F=Redux.createStore:
h("Redux is undefined"));var h=function(a){throw Error("CausalityRedux: "+a);},y=b.merge=Object.assign,z=function(a){return Object.prototype.toString.call(a).slice(8,-1)},u=b.getKeys=function(a){return("undefined"===typeof a?"undefined":g(a))===e?[]:[].concat(t(Object.keys(a)),t(Object.getOwnPropertySymbols(a)))},R=function(a){return K.partitionDefinitions.find(function(c){return a===c.partitionName})},I=function(a){return Y.find(function(c){return a===c.pluginId})},W=function(a,c,b,h,d,m,f){"function"===
typeof M&&("setState"===m&&(b="setState"),a={partitionName:a.toString(),type:c,operation:("undefined"===typeof b?"undefined":g(b))===e?"User defined":b,prevState:h,nextState:d,changerName:m,args:f},M(a))},P=function(a,c,b){"function"===typeof J&&J({partitionName:a.toString(),nextState:c,listenerName:b})},la=function(a,c){var b=arguments[3],e=y([],2<arguments.length&&void 0!==arguments[2]?arguments[2]:[]),b={id:ka++,listener:a,partitionName:c,stateEntries:e,listenerName:b};G.push(b);return b.id},ma=
function(a){G=G.filter(function(c){return c.id!==a})},na=function(a,c,b,d){return function(){var m,p=(m=c.changers)[b].apply(m,arguments);if(g(c.changerDefinitions[b])===e){if(("undefined"===typeof p?"undefined":g(p))===e||"Object"!==z(p)){h("Changer "+b+" must return an action object.");return}}else if(("undefined"===typeof p?"undefined":g(p))===e)return;p.type=g(p.type)===e?"":p.type;p.reducer=c.reducers[d];p.partitionName=c.partitionName;p.reducerName=d;a.dispatch(p)}},oa=function(a){return function(c,
b){var d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";Array.isArray(b)||h("subscribe: the 2nd argument must be an array of keys to listen on.");var p=R(a);b.forEach(function(c){var d=!1;g(p.defaultState[c])!==e?d=!0:u(p.changerDefinitions).forEach(function(a){a===c&&(1<b.length&&h("Can only subscribe to one changer event."),d=!0)});if(!d)throw c+" is not a valid key in the state partition "+a+".";});return function(a){return function(){ma(a)}}(la(c,a,b,d))}},pa=function(a,c){return function(){return a.getState()[c]}},
qa=function(a,c){return function(b){z(b)||h("The Argument to setState must be an object.");var e={};e.theirArgs=b;e.isSetState=!0;e.arguments=[];e.changerName="setState";e.type="setState";e.partitionName=c;a.dispatch(e)}},ra=function(a){g(a.partitionName)===e&&h("partitionName not found.");g(a.defaultState)===e&&h("defaultState missing from entry: "+a.partitionName);g(a.changers)===e&&h("changers missing from entry: "+a.partitionName);g(a.reducers)===e&&h("reducers missing from entry: "+a.partitionName)},
sa={get:function(a,c){a=a.getState()[c];return a instanceof Object?ha(a):a},set:function(a,c,b){var e={};e[c]=b;a.setState(e);return!0}},fa=function(a,c){ra(c);var b=c.partitionName;a[b]={};var d=a[b];u(c.changers).forEach(function(b){var m=b+"Reducer";g(c.changerDefinitions[b])!==e&&g(c.changerDefinitions[b].pluginId)!==e||g(c.reducers[m])!==e||h("'Reducer: "+m+" not found.");d[b]=na(a,c,b,m)});d.subscribe=oa(b);d.getState=pa(a,b);d.setState=qa(a,b);d.partitionState=new Proxy(d,sa)},ea=function(a){if(a.changerDefinitions){var c=
function(a){return a===m.STATE_ARRAY_ADD||a===m.STATE_ARRAY_DELETE||a===m.STATE_ARRAY_ENTRY_MERGE},b=function(a,c,b,d){d.length!==b.length&&h("Incorrect number of arguments for "+c+" call.");for(var k=0;k<d.length;++k)g(a[b[k]])===e?h('Invalid argument name "'+b[k]+'" for '+c+" call."):"Object"!==z(a[b[k]])&&z(a[b[k]])!==z(d[k])&&h("Incorrect argument type for argument #"+(k+1)+" for "+c+" call.")},d=function(a,c){var b=u(a),k=u(c),d="";b.some(function(b){g(c[b])===e?d=b+" is missing in the first argument":
a[b]!==z(c[b])&&(d="Invalid type for "+b+" in the first argument");return""!==d});""===d&&k.some(function(c){g(a[c])===e&&(d="'"+c+"' is an invalid field in the first argument");return""!==d});return d},f=function(b){u(b).forEach(function(b){ia.some(function(a){return b===a})||h(b+" is an invalid entry in "+a.partitionName+".")});g(b.arguments)!==e&&(Array.isArray(b.arguments)||h("'arguments' must be an array for '"+o+"' in partitionName = "+a.partitionName+"."));c(b.operation)?(g(b.keyIndexerName)!==
e&&g(b.keyName)===e&&h("The keyIndexerName is defined in "+o+" but keyName is not defined."),g(a.defaultState[b.arrayName])===e?h("Missing the 'arrayName' definition for entry '"+o+"' in partitionName = "+a.partitionName+"."):Array.isArray(a.defaultState[b.arrayName])||h(b.arrayName+" is not an array for entry '"+o+"' in partitionName = "+a.partitionName+".")):b.operation===m.STATE_TOGGLE?(g(b.impliedArguments)!==e&&0!==b.impliedArguments.length||h("impliedArguments is required for '"+o+"' in partitionName = "+
a.partitionName+"."),b.impliedArguments.forEach(function(b){"Boolean"!==z(a.defaultState[b])&&h("The impliedArgument "+b+" is not Boolean as required by the Toggle operation in '"+o+"' of partitionName = "+a.partitionName+".")})):b.operation===m.STATE_INCREMENT||b.operation===m.STATE_DECREMENT?(g(b.impliedArguments)!==e&&1===b.impliedArguments.length||h("impliedArguments with 1 entry is required for '"+o+"' in stateName = "+a.stateName+"."),b.impliedArguments.forEach(function(c){"Number"!==z(a.defaultState[c])&&
h("The impliedArgument "+c+" is not a Number as required by the "+b.operation+" operation in '"+o+"' of partitionName = "+a.partitionName+".")})):b.operation===m.STATE_OBJECT_MERGE?(g(b.arguments)!==e&&0!==b.arguments.length||h("'arguments' is required for '"+o+"' in partitionName = "+a.partitionName+"."),1!==b.arguments.length&&h("STATE_OBJECT_MERGE allows only 1 argument for '"+o+"' in partitionName = "+a.partitionName+".")):b.operation===m.STATE_SETTODEFAULTS&&(g(b.impliedArguments)!==e&&0!==b.impliedArguments.length||
h("'impliedArguments' is required for '"+o+"' in partitionName = "+a.partitionName+"."))},n=function(k,f,l){return function(){for(var r=arguments.length,x=Array(r),p=0;p<r;p++)x[p]=arguments[p];var v=[].concat(x);if(l.operation===m.STATE_FUNCTION_CALL){var n=[];G.forEach(function(a){Array.isArray(a.stateEntries)||h("Listenername="+a.listenerName+", partitionName="+a.partitionName+" is not an array.");a.stateEntries.forEach(function(b){b===f&&n.push(a)})});0===n.length&&h("There is no subscriber to "+
f+" in "+k+".");if(l.impliedArguments){var u=w[k].getState();if(u){var q={};l.impliedArguments.forEach(function(a){q[a]=u[a]});v.push(q)}}var y={functionArguments:v};W(k,f,l.operation,{},y,f,v);n.forEach(function(a){P(k,y,a.listenerName);a.listener.apply(a,t(v))})}else{r={};r.changerName=f;r.theirArgs=v;r.type=g(l.type)===e?f:l.type;r.arguments=g(l.arguments)===e?[]:l.arguments;r.impliedArguments=g(l.impliedArguments)===e?[]:l.impliedArguments;r.operation=g(l.operation)===e?m.STATE_COPY:l.operation;
r.partitionName=k;r.changerDefinition=l;if(g(l.pluginId)!==e)return x=I(l.pluginId),"function"===typeof x.validateChangerArguments&&x.validateChangerArguments.apply(x,t(v)),r.pluginCallback=x.pluginCallback,r;if(c(l.operation))l.operation===m.STATE_ARRAY_ADD&&"Object"!==z(v[0])&&h("STATE_ARRAY_ADD can only accept pure base objects. You must define your own changers and reducers for this object."),l.operation===m.STATE_ARRAY_ADD||l.operation===m.STATE_ARRAY_DELETE?(1!==v.length&&h("Only one argument is allowed with "+
l.operation+" for entry '"+f+"' in partitionName = "+a.partitionName+"."),l.operation===m.STATE_ARRAY_ADD&&g(l.arrayArgShape)!==e&&(x=d(l.arrayArgShape,v[0]),""!==x&&h(x+" for "+f))):(2!==v.length&&h("Two arguments are required with "+l.operation+" for entry '"+f+"' in partitionName = "+a.partitionName+"."),g(l.arrayArgShape)!==e&&(x=d(l.arrayArgShape,v[1]),""!==x&&h(x+" for "+f))),r.arrayArg=l.operation===m.STATE_ARRAY_DELETE||l.operation===m.STATE_ARRAY_ENTRY_MERGE?v[0].toString():v[0],r.arrayEntryArg=
v[1],r.arrayName=l.arrayName,r.keyIndexerName=l.keyIndexerName,r.keyName=l.keyName;else if(l.operation===m.STATE_OBJECT_MERGE)1!==v.length&&h("STATE_OBJECT_MERGE allows only 1 argument for "+f+"."),r[r.arguments[0]]=v[0];else if(l.operation===m.STATE_SETTODEFAULTS||l.operation===m.STATE_TOGGLE)0!==v.length&&h(l.operation+" allows only 0 arguments for "+f);else if(l.operation!==m.STATE_FUNCTION_CALL&&(b(a.defaultState,f,r.arguments,v),0<v.length))for(x=0;x<v.length;++x)r[r.arguments[x]]=v[x];return r}}},
q=function(a,b){return function(c,d){var f=y({},c);c=[];var k=c=void 0;g(d.operation)===e&&(d.operation=m.STATE_COPY);switch(d.operation){case m.STATE_COPY:d.arguments.forEach(function(a){f[a]=d[a]});break;case m.STATE_TOGGLE:d.impliedArguments.forEach(function(a){f[a]=!f[a]});break;case m.STATE_INCREMENT:d.impliedArguments.forEach(function(a){f[a]+=1});break;case m.STATE_DECREMENT:d.impliedArguments.forEach(function(a){--f[a]});break;case m.STATE_SETTODEFAULTS:b.impliedArguments.forEach(function(a){f[a]=
D[d.partitionName][a]});break;case m.STATE_ARRAY_ADD:c=[].concat(t(f[d.arrayName]));d.keyIndexerName&&(k=parseInt(f[d.keyIndexerName])||0,d.arrayArg[d.keyName]=k.toString(),++k,f[d.keyIndexerName]=k.toString());c.push(d.arrayArg);f[d.arrayName]=c;break;case m.STATE_ARRAY_DELETE:c=f[d.arrayName].filter(function(a){return a[d.keyName]!==d.arrayArg});f[d.arrayName]=c;break;case m.STATE_ARRAY_ENTRY_MERGE:c=[].concat(t(f[d.arrayName]));k=f[d.arrayName].findIndex(function(a){return a[d.keyName]===d.arrayArg});
0<=k&&(c[k]=y(c[k],d.arrayEntryArg),f[d.arrayName]=c);break;case m.STATE_OBJECT_MERGE:c=d.arguments[0];f[c]=y(f[c],d[c]);break;default:h("Unknown operation entry in "+a+".")}return f}};g(a.changers)===e&&(a.changers={});g(a.reducers)===e&&(a.reducers={});u(a.changerDefinitions).forEach(function(c){var b=a.changerDefinitions[c];("undefined"===typeof b?"undefined":g(b))===e&&h("Changer definition argument for "+c+" must be defined");f(b);a.changers[c]=n(a.partitionName,c,b);var d=c+"Reducer";g(a.reducers[d])===
e&&(g(b.pluginId)!==e?a.reducers[d]=I(b.pluginId).reducer:a.reducers[d]=q(c,b))})}},ga=function(a){ja.forEach(function(c){g(a[c])===e&&h("Key "+c+" is missing from the plugin.");"function"!==typeof a.reducer&&"function"!==typeof a.pluginCallback&&h("The plugin must have either a reducer function or a pluginCallback function.")})},K={createStore:H,addPartitions:Q,addPlugins:X,subscribe:Z,onStoreCreated:aa,setOptions:L,shallowEqual:f,merge:y,getKeys:u,operations:m,get store(){return w},get reduxStore(){return N},
get defaultState(){return D},get partitionDefinitions(){return B},get onListener(){return J}};b.default=K},function(n,b,d){n=(n=d(0))&&n.__esModule?n:{default:n};"undefined"!==typeof window&&(window.CausalityRedux=n.default)},function(n,b){n.exports=function(b){if(!b||"object"!==typeof b)return b;var f;if(t(b)){var n=b.length;f=Array(n);for(var q=0;q<n;q++)f[q]=b[q]}else{n=d(b);f={};for(var q=0,A=n.length;q<A;q++){var H=n[q];f[H]=b[H]}}return f};var d=Object.keys||function(b){var d=[],f;for(f in b)({}).hasOwnProperty.call(b,
f)&&d.push(f);return d},t=Array.isArray||function(b){return"[object Array]"==={}.toString.call(b)}},function(n,b){n.exports=Redux},function(n,b,d){d(0);n.exports=d(1)}])}]);
