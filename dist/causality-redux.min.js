/*
 ? 2017 Andrew Banks ALL RIGHTS RESERVED */
(function(r){function m(b){if(u[b])return u[b].exports;var e=u[b]={i:b,l:!1,exports:{}};r[b].call(e.exports,e,e.exports,m);e.l=!0;return e.exports}var u={};m.m=r;m.c=u;m.i=function(b){return b};m.d=function(b,e,t){m.o(b,e)||Object.defineProperty(b,e,{configurable:!1,enumerable:!0,get:t})};m.n=function(b){var e=b&&b.__esModule?function(){return b["default"]}:function(){return b};m.d(e,"a",e);return e};m.o=function(b,e){return Object.prototype.hasOwnProperty.call(b,e)};m.p="";return m(m.s=0)})([function(r,
m){(function(m){function b(t){if(e[t])return e[t].exports;var c=e[t]={i:t,l:!1,exports:{}};m[t].call(c.exports,c,c.exports,b);c.l=!0;return c.exports}var e={};b.m=m;b.c=e;b.i=function(b){return b};b.d=function(t,c,e){b.o(t,c)||Object.defineProperty(t,c,{configurable:!1,enumerable:!0,get:e})};b.n=function(e){var c=e&&e.__esModule?function(){return e["default"]}:function(){return e};b.d(c,"a",c);return c};b.o=function(b,c){return Object.prototype.hasOwnProperty.call(b,c)};b.p="";return b(b.s=1)})([function(m,
b){m.exports=Redux},function(m,b,e){function t(c){if(Array.isArray(c)){for(var b=0,e=Array(c.length);b<c.length;b++)e[b]=c[b];return e}return Array.from(c)}var c="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"===typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},u=e(0),r=function(){function b(a,c){if(a===c)return!0;var d=Object.keys(a),f=Object.keys(c);if(d.length!==f.length)return!1;for(var f=
Object.prototype.hasOwnProperty,b=0;b<d.length;b++)if(!f.call(c,d[b])||a[d[b]]!==c[d[b]])return!1;return!0}function e(a,d){"undefined"===c(d.partitionName)&&f("partitionName not found.");"undefined"===c(d.defaultState)&&f("defaultState missing from entry: "+d.partitionName);"undefined"===c(d.changers)&&f("changers missing from entry: "+d.partitionName);"undefined"===c(d.reducers)&&f("reducers missing from entry: "+d.partitionName);a[d.partitionName]={};for(var b in d.changers){var e=b+"Reducer";"undefined"===
c(d.reducers[e])&&f("'Reducer: "+e+" not found.");a[d.partitionName][b]=function(b,f){return function(){var e,h=(e=d.changers)[b].apply(e,arguments);"undefined"!==("undefined"===typeof h?"undefined":c(h))&&(h.type="undefined"===c(h.type)?"":h.type,h.reducer=d.reducers[f],h.partitionName=d.partitionName,h.reducerName=f,a.dispatch(h))}}(b,e)}a[d.partitionName].subscribe=function(a){return function(d,b){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";Array.isArray(b)||f("subscribe: the 2nd argument must be an array of keys to listen on.");
var h=E(a);b.forEach(function(d){var g=!1;if("undefined"!==c(h.defaultState[d]))g=!0;else for(var P in h.changerDefinitions)P===d&&(1<b.length&&f("Can only subscribe to one changer event."),g=!0);if(!g)throw d+" is not a valid key in the state partition "+a+".";});return function(a){return function(){Q(a)}}(R(d,a,b,e))}}(d.partitionName);a[d.partitionName].getState=function(a,c){return function(){return a.getState()[c]}}(a,d.partitionName)}function m(a){a=[a];v=v.concat(a);a.forEach(function(a){S.forEach(function(b){"undefined"===
c(a[b])&&f(b+" is a required entry in "+a.partitionName+".")});var b=function(c){T.some(function(a){return c===a})||f(c+" is not a valid entry in "+a.partitionName+".")},d;for(d in a)b(d);U(a);e(q,a)})}function N(){w=x({},0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});w.onStateChange&&("function"!==typeof w.onStateChange&&f("options.onStateChange must be a function."),F=w.onStateChange);w.onListener&&("function"!==typeof w.onListener&&f("options.onListener must be a function."),C=w.onListener)}
function V(a,d,e){var k=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};"undefined"===("undefined"===typeof a?"undefined":c(a))&&f("Missing first parameter partitionDefinitions.");N(k);a.forEach(function(a){y[a.partitionName]=x({},a.defaultState)});var h={};"undefined"!==("undefined"===typeof d?"undefined":c(d))?[].concat(t(Object.keys(y)),t(Object.keys(d))).forEach(function(a){h[a]=x({},y[a],d[a])}):h=void 0;G=A(function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:y,
c=arguments[1];H||(H=a);if("function"!==typeof c.reducer)return a;var d={};v.forEach(function(c){d[c.partitionName]=a[c.partitionName]});d[c.partitionName]=c.reducer(a[c.partitionName],c);if(b(d[c.partitionName],a[c.partitionName]))return a;O(c.partitionName,c.type,c.operation,a[c.partitionName],d[c.partitionName],c.changerName,c.theirArgs);I[c.partitionName]=!0;return d},h,e);q=Object.create(G);q.subscribe(function(){var a=q.getState(),d=function(d){B.forEach(function(b){if(d===b.partitionName)if(0===
b.stateEntries.length)J(d,a[d],b.listenerName),b.listener(a[d]);else{var f=!0;"undefined"===c(b.prevState)?b.stateEntries.forEach(function(c){f=f&&a[d][c]===H[d][c]}):b.stateEntries.forEach(function(c){f=f&&a[d][c]===b.prevState[c]});if(!f){var e={};b.stateEntries.forEach(function(c){e[c]=a[d][c]});b.prevState=e;J(d,e,b.listenerName);b.listener(e)}}})},b;for(b in I)d(b);I={}});a.forEach(function(a){m(a)});return q}var k={STATE_COPY:1,STATE_ARRAY_ADD:2,STATE_ARRAY_DELETE:3,STATE_ARRAY_ENTRY_MERGE:4,
STATE_OBJECT_MERGE:5,STATE_TOGGLE:6,STATE_FUNCTION_CALL:7,STATE_SETTODEFAULTS:8,STATE_INCREMENT:9,STATE_DECREMENT:10},W="arguments impliedArguments type operation arrayName keyIndexerName keyName arrayArgShape".split(" "),T=["partitionName","defaultState","changers","reducers","changerDefinitions"],S=["partitionName","defaultState"],y={},q=null,G=null,I={},B=[],X=0,v=[],w={},F=null,C=null,H=null,K=[],L=[],f=function(a){throw Error("CausalityRedux: "+a);},x=Object.assign,A=void 0;"undefined"!==("undefined"===
typeof u.createStore?"undefined":c(u.createStore))&&(A=u.createStore);"undefined"===("undefined"===typeof A?"undefined":c(A))&&("undefined"!==("undefined"===typeof Redux?"undefined":c(Redux))?A=Redux.createStore:f("Redux is undefined"));var z=function(a){return Object.prototype.toString.call(a).slice(8,-1)},E=function(a){return r.partitionDefinitions.find(function(c){return a===c.partitionName})},O=function(a,b,f,e,k,m,q){"function"===typeof F&&(a={partitionName:a,type:b,operation:"undefined"===("undefined"===
typeof f?"undefined":c(f))?"User defined":f,prevState:e,nextState:k,changerName:m,args:q},F(a))},J=function(a,c,b){"function"===typeof C&&C({partitionName:a,nextState:c,listenerName:b})},Q=function(a){B=B.filter(function(c){return c.id!==a})},R=function(a,c){var b=arguments[3],d=x([],2<arguments.length&&void 0!==arguments[2]?arguments[2]:[]),b={id:X++,listener:a,partitionName:c,stateEntries:d,listenerName:b};B.push(b);return b.id},U=function(a){if(a.changerDefinitions){var b=function(a,b,d,e){e.length!==
d.length&&f("Incorrect number of arguments for "+b+" call.");for(var g=0;g<e.length;++g)"undefined"===c(a[d[g]])?f('Invalid argument name "'+d[g]+'" for '+b+" call."):"Object"!==z(a[d[g]])&&z(a[d[g]])!==z(e[g])&&f("Incorrect argument type for argument #"+(g+1)+" for "+b+" call.")},e=function(a,b){var d=Object.keys(a),f=Object.keys(b),e="";d.some(function(d){"undefined"===c(b[d])?e=d+" is missing in the first argument":a[d]!==z(b[d])&&(e="Invalid type for "+d+" in the first argument");return""!==e});
""===e&&f.some(function(b){"undefined"===c(a[b])&&(e="'"+b+"' is an invalid field in the first argument");return""!==e});return e},m=function(a){return a===k.STATE_ARRAY_ADD||a===k.STATE_ARRAY_DELETE||a===k.STATE_ARRAY_ENTRY_MERGE},h;for(h in a.changerDefinitions){var u=a.changerDefinitions[h],v=function(c){W.some(function(a){return c===a})||f(c+" is an invalid entry in "+a.partitionName+".")},r;for(r in u)v(r)}"undefined"===c(a.changers)&&(a.changers={});h=function(d){var g=a.changerDefinitions[d];
"undefined"!==c(g.arguments)&&(Array.isArray(g.arguments)||f("'arguments' must be an array for '"+d+"' in partitionName = "+a.partitionName+"."));"undefined"===("undefined"===typeof g?"undefined":c(g))&&f("Changer definition argument for "+d+" must be defined");m(g.operation)?("undefined"!==c(g.keyIndexerName)&&"undefined"===c(g.keyName)&&f("The keyIndexerName is defined in "+d+" but keyName is not defined."),"undefined"===c(a.defaultState[g.arrayName])?f("Missing the 'arrayName' definition for entry '"+
d+"' in partitionName = "+a.partitionName+"."):Array.isArray(a.defaultState[g.arrayName])||f(g.arrayName+" is not an array for entry '"+d+"' in partitionName = "+a.partitionName+".")):g.operation===k.STATE_TOGGLE?("undefined"!==c(g.impliedArguments)&&0!==g.impliedArguments.length||f("impliedArguments is required for '"+d+"' in partitionName = "+a.partitionName+"."),g.impliedArguments.forEach(function(c){"Boolean"!==z(a.defaultState[c])&&f("The impliedArgument "+c+" is not Boolean as required by the Toggle operation in '"+
d+"' of partitionName = "+a.partitionName+".")})):g.operation===k.STATE_INCREMENT||g.operation===k.STATE_DECREMENT?("undefined"!==c(g.impliedArguments)&&1===g.impliedArguments.length||f("impliedArguments with 1 entry is required for '"+d+"' in stateName = "+a.stateName+"."),g.impliedArguments.forEach(function(c){"Number"!==z(a.defaultState[c])&&f("The impliedArgument "+c+" is not a Number as required by the "+g.operation+" operation in '"+d+"' of partitionName = "+a.partitionName+".")})):g.operation===
k.STATE_OBJECT_MERGE?("undefined"!==c(g.arguments)&&0!==g.arguments.length||f("'arguments' is required for '"+d+"' in partitionName = "+a.partitionName+"."),1!==g.arguments.length&&f("STATE_OBJECT_MERGE allows only 1 argument for '"+d+"' in partitionName = "+a.partitionName+".")):g.operation===k.STATE_SETTODEFAULTS&&("undefined"!==c(g.impliedArguments)&&0!==g.impliedArguments.length||f("'impliedArguments' is required for '"+d+"' in partitionName = "+a.partitionName+"."));a.changers[d]=function(d,
g,l){return function(){for(var n=arguments.length,h=Array(n),D=0;D<n;D++)h[D]=arguments[D];var p=[].concat(h);if(l.operation===k.STATE_FUNCTION_CALL){var M=[];B.forEach(function(a){Array.isArray(a.stateEntries)||f("Listenername="+a.listenerName+", partitionName="+a.partitionName+" is not an array.");a.stateEntries.forEach(function(c){c===g&&M.push(a)})});0===M.length&&f("There is no subscriber to "+g+" in "+d+".");if(l.impliedArguments){var r=q[d].getState();if(r){var u={};l.impliedArguments.forEach(function(a){u[a]=
r[a]});p.push(u)}}var v={functionArguments:p};O(d,g,l.operation,{},v,g,p);M.forEach(function(a){J(d,v,a.listenerName);a.listener.apply(a,t(p))})}else{n={};n.changerName=g;n.theirArgs=p;n.type="undefined"===c(l.type)?g:l.type;n.arguments="undefined"===c(l.arguments)?[]:l.arguments;n.impliedArguments="undefined"===c(l.impliedArguments)?[]:l.impliedArguments;n.operation="undefined"===c(l.operation)?k.STATE_COPY:l.operation;n.partitionName=d;if(m(l.operation))l.operation===k.STATE_ARRAY_ADD&&"Object"!==
z(p[0])&&f("STATE_ARRAY_ADD can only accept pure base objects. You must define your own changers and reducers for this object."),l.operation===k.STATE_ARRAY_ADD||l.operation===k.STATE_ARRAY_DELETE?(1!==p.length&&f("Only one argument is allowed with "+l.operation+" for entry '"+g+"' in partitionName = "+a.partitionName+"."),l.operation===k.STATE_ARRAY_ADD&&"undefined"!==c(l.arrayArgShape)&&(h=e(l.arrayArgShape,p[0]),""!==h&&f(h+" for "+g))):(2!==p.length&&f("Two arguments are required with "+l.operation+
" for entry '"+g+"' in partitionName = "+a.partitionName+"."),"undefined"!==c(l.arrayArgShape)&&(h=e(l.arrayArgShape,p[1]),""!==h&&f(h+" for "+g))),n.arrayArg=l.operation===k.STATE_ARRAY_DELETE||l.operation===k.STATE_ARRAY_ENTRY_MERGE?p[0].toString():p[0],n.arrayEntryArg=p[1],n.arrayName=l.arrayName,n.keyIndexerName=l.keyIndexerName,n.keyName=l.keyName;else if(l.operation===k.STATE_OBJECT_MERGE)1!==p.length&&f("STATE_OBJECT_MERGE allows only 1 argument for "+g+"."),n[n.arguments[0]]=p[0];else if(l.operation===
k.STATE_SETTODEFAULTS||l.operation===k.STATE_TOGGLE)0!==p.length&&f(l.operation+" allows only 0 arguments for "+g);else if(l.operation!==k.STATE_FUNCTION_CALL&&(b(a.defaultState,g,n.arguments,p),0<p.length))for(h=0;h<p.length;++h)n[n.arguments[h]]=p[h];return n}}}(a.partitionName,d,g);var h=d+"Reducer",r=void 0;"undefined"!==c(a.reducers)&&(r=a.reducers[h]);"undefined"!==("undefined"===typeof r?"undefined":c(r))?a.reducers[h]=function(a){return function(c,d){var b=[c];d.arguments.forEach(function(a){b.push(d[a])});
return a.apply(void 0,b)}}(r):("undefined"===c(a.reducers)&&(a.reducers={}),a.reducers[h]=function(a){return function(d,b){var e=x({},d);d=[];var h=d=void 0;"undefined"===c(b.operation)&&(b.operation=k.STATE_COPY);switch(b.operation){case k.STATE_COPY:b.arguments.forEach(function(a){e[a]=b[a]});break;case k.STATE_TOGGLE:b.impliedArguments.forEach(function(a){e[a]=!e[a]});break;case k.STATE_INCREMENT:b.impliedArguments.forEach(function(a){e[a]+=1});break;case k.STATE_DECREMENT:b.impliedArguments.forEach(function(a){--e[a]});
break;case k.STATE_SETTODEFAULTS:g.impliedArguments.forEach(function(a){e[a]=y[b.partitionName][a]});break;case k.STATE_ARRAY_ADD:d=[].concat(t(e[b.arrayName]));b.keyIndexerName&&(h=parseInt(e[b.keyIndexerName])||0,b.arrayArg[b.keyName]=h.toString(),++h,e[b.keyIndexerName]=h.toString());d.push(b.arrayArg);e[b.arrayName]=d;break;case k.STATE_ARRAY_DELETE:d=e[b.arrayName].filter(function(a){return a[b.keyName]!==b.arrayArg});e[b.arrayName]=d;break;case k.STATE_ARRAY_ENTRY_MERGE:d=[].concat(t(e[b.arrayName]));
h=e[b.arrayName].findIndex(function(a){return a[b.keyName]===b.arrayArg});0<=h&&(d[h]=x(d[h],b.arrayEntryArg),e[b.arrayName]=d);break;case k.STATE_OBJECT_MERGE:d=b.arguments[0];e[d]=x(e[d],b[d]);break;default:f("Unknown operation entry in "+a+".")}return e}}(d))};for(var w in a.changerDefinitions)h(w)}};return{createStore:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],b=arguments[1],e=arguments[2],k=arguments[3];null!==q&&f("CausalityRedux is already initialized.");a=a.filter(function(a){return"undefined"===
c(E(a.partitionName))});a=v.concat(a);v=[];q=V(a,b,e,k);K.forEach(function(a){return a()});K=[];L.forEach(function(a){"undefined"===c(q[a.partitionName])&&f("${e.partitionName} is an invalid partition.");q[a.partitionName].subscribe(a.listener,a.arrKeys,a.listenerName)});L=[];return q},addPartitions:function(a){Array.isArray(a)||(a=[a]);a=a.filter(function(a){return"undefined"===c(E(a.partitionName))});null!==q?a.forEach(function(a){y[a.partitionName]=x({},a.defaultState);m(a)}):v=v.concat(a)},subscribe:function(a,
b,e,k){"function"!==typeof b&&f("subscribe listener argument is not a function.");Array.isArray(e)||f("subscribe: the 3rd argument must be an array of keys to listen on.");null!==q?("undefined"===c(q[a])&&f("${partitionName} is an invalid partition."),q[a].subscribe(b,e,k)):L.push({partitionName:a,listener:b,arrKeys:e,listenerName:k})},onStoreCreated:function(a){"function"!==typeof a&&f("onStoreCreated argument is not a function.");null!==q?a():K.push(a)},setOptions:N,get store(){return q},get reduxStore(){return G},
get operations(){return k},get partitionDefinitions(){return v},get onListener(){return C},get defaultState(){return y},get shallowEqual(){return b},get merge(){return x}}}();"undefined"!==typeof window&&(window.CausalityRedux=r);m.exports=r}])}]);
